{% extends "master/base.html" %} 
{% load static %} 
{% block content %}

<!-- Page Wrapper -->
<div class="page-wrapper">
  <!-- Page Content -->
  <div class="content container-fluid">
    <!-- Page Header -->
    <div class="page-header">
      <div class="row align-items-center">
        <div class="col">
          <h3 class="page-title">Employee</h3>
          <ul class="breadcrumb">
            <li class="breadcrumb-item"><a href="admin-dashboard.html">Dashboard</a></li>
            <li class="breadcrumb-item active">Employee</li>
          </ul>
        </div>
        <div class="col-auto float-end ms-auto">
          <a href="{% url 'add_employee' %}" class="btn add-btn"><i class="fa-solid fa-plus"></i> Add Employee</a>
          <div class="view-icons">
            <a href="{% url 'employeeList' %}" class="grid-view btn btn-link {% if request.resolver_match.url_name == 'employeeList' %}active{% endif %}"><i class="fa fa-th"></i></a>
            <a href="{% url 'employeeListView' %}" class="list-view btn btn-link {% if request.resolver_match.url_name == 'employeeListView' %}active{% endif %}"><i class="fa-solid fa-bars"></i></a>
          </div>
        </div>
      </div>
    </div>
    <!-- /Page Header -->

    <!-- Search Filter -->
    <div class="row filter-row">
      <div class="col-sm-6 col-md-3">
        <div class="input-block mb-3 form-focus">
          <input type="text" class="form-control floating" name="employee_id"/>
          <label class="focus-label">Employee ID</label>
        </div>
      </div>
      <div class="col-sm-6 col-md-3">
        <div class="input-block mb-3 form-focus">
          <input type="text" class="form-control floating" name="employee_name"/>
          <label class="focus-label">Employee Name</label>
        </div>
      </div>
      <div class="col-sm-6 col-md-3">
        <div class="input-block mb-3 form-focus select-focus">
          <select class="select floating" name="designation"> 
            <option value="">Select Designation</option>
            {% for designation in designations %}
              <option value="{{ designation.id }}">{{ designation.title }}</option>
            {% endfor %}
          </select>
          <label class="focus-label">Designation</label>
        </div>
      </div>
      <div class="col-sm-6 col-md-3">
        <button type="submit" class="btn btn-success w-100">Search</button>
      </div>
    </div>
    <!-- /Search Filter -->

    <div class="row">
      <div class="col-md-12">
        <div class="table-responsive">
          <table class="table table-striped custom-table datatable">
            <thead>
              <tr>
                <th>Name</th>
                <th>Employee ID</th>
                <th>Email</th>
                <th>Mobile</th>
                <th class="text-nowrap">Join Date</th>
                <th>Role</th>
                <th class="text-end no-sort">Action</th>
              </tr>
            </thead>
            <tbody>
              {% for employee in employees %}
              <tr>
                <td>
                  <h2 class="table-avatar">
                    <a href="" class="avatar">
                      {% if employee.profile_image %}
                        <img src="{{ employee.profile_image.url }}" alt="{{ employee.full_name }}">
                      {% else %}
                        <img src="{% static 'assets/img/default-avatar.png' %}" alt="Default Avatar">
                      {% endif %}
                    </a>
                    <a href="">
                      {{ employee.full_name }} 
                      <span>
                        {% if employee.position %}
                          {{ employee.position.title }}
                        {% else %}
                          No Designation
                        {% endif %}
                      </span>
                    </a>
                  </h2>
                </td>
                <td>{{ employee.employee_id }}</td>
                <td>{{ employee.user.email }}</td>
                <td>{{ employee.phone }}</td>
                <td>{{ employee.date_of_joining|date:"d M Y" }}</td>
                <td>
                  {% if employee.position %}
                    {{ employee.position.title }}
                  {% else %}
                    No Designation
                  {% endif %}
                </td>
                <td class="text-end">
                  <div class="dropdown dropdown-action">
                    <a href="#" class="action-icon dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="material-icons">more_vert</i></a>
                    <div class="dropdown-menu dropdown-menu-right">
                      <a class="dropdown-item" href="{% url 'update_profile' employee.id %}"><i class="fa-solid fa-pencil m-r-5"></i> Edit</a>
                      <a class="dropdown-item" href="{% url 'delete_employee' employee.id %}"><i class="fa-regular fa-trash-can m-r-5"></i> Delete</a>
                    </div>
                  </div>
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="7" class="text-center text-muted">No employees found.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <!-- /Page Content -->
</div>
<!-- /Page Wrapper -->
{% endblock content %}
